<Window x:Class="Vms_page.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Guard Station" Height="600" Width="1000"
        Background="#1B1E2B" WindowStyle="None" ResizeMode="CanResize">

    <Window.Resources>
        <LinearGradientBrush x:Key="TopBarBackground" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#2A2D3E" Offset="0"/>
            <GradientStop Color="#1E2128" Offset="1"/>
        </LinearGradientBrush>
    </Window.Resources>

    <DockPanel LastChildFill="True">

        <!-- ✅ Top Bar -->
        <Border DockPanel.Dock="Top" Height="45"
                Background="{StaticResource TopBarBackground}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Control Panel Button -->
                <Button Grid.Column="1" Content="Control Panel" Padding="16,4"
                        Margin="25,0,0,0"
                        Background="#383C4C"
                        Foreground="#61A0FF"
                        BorderThickness="0"
                        FontWeight="Bold"
                        FontSize="14"
                        VerticalAlignment="Center"
                        Cursor="Hand">
                    <Button.Effect>
                        <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="2" Opacity="0.3"/>
                    </Button.Effect>
                </Button>

                <!-- Right Icons and Admin -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,15,0">
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE80C;" ToolTip="Dashboard" Foreground="#B0BEC5" FontSize="18" Margin="8,0"/>
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE77B;" ToolTip="Uniform" Foreground="#B0BEC5" FontSize="18" Margin="8,0"/>
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE706;" ToolTip="Uniform" Foreground="#B0BEC5" FontSize="18" Margin="8,0"/>
                    <TextBlock Text="admin" Foreground="#61A0FF" FontWeight="Bold" VerticalAlignment="Center" Margin="8,0" FontSize="14"/>
                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE72E;" ToolTip="Lock" Foreground="#B0BEC5" FontSize="18" Margin="8,0"/>
                    <Grid Margin="8,0">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE897;" ToolTip="Help" Foreground="#B0BEC5" FontSize="18"/>
                    </Grid>
                    <!-- Window Control Buttons -->
                    <Button x:Name="MinimizeButton" Click="MinimizeButton_Click" ToolTip="Minimize"
                            Background="Transparent" BorderThickness="0" Margin="8,0">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE921;" Foreground="#B0BEC5" FontSize="18"/>
                    </Button>
                    <Button x:Name="MaximizeButton" Click="MaximizeButton_Click" ToolTip="Maximize"
                            Background="Transparent" BorderThickness="0" Margin="8,0">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE922;" Foreground="#B0BEC5" FontSize="18"/>
                    </Button>
                    <Button x:Name="CloseButton" Click="CloseButton_Click" ToolTip="Close"
                            Background="Transparent" BorderThickness="0" Margin="8,0">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8BB;" Foreground="#B0BEC5" FontSize="18"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ✅ Bottom Navigation Bar -->
        <Border DockPanel.Dock="Bottom" Height="40">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,1" EndPoint="0,0">
                    <GradientStop Color="#1E2128" Offset="0"/>
                    <GradientStop Color="#2A2D3E" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="20,0,0,0">
                <TextBlock Text="⚠️" Foreground="#B0BEC5" FontSize="16" Margin="12,0"/>
                <TextBlock Text="⏬" Foreground="#B0BEC5" FontSize="16" Margin="12,0"/>
                <TextBlock Text="📋" Foreground="#B0BEC5" FontSize="16" Margin="12,0"/>
                <TextBlock Text="📂" Foreground="#B0BEC5" FontSize="16" Margin="12,0"/>
            </StackPanel>
        </Border>

        <!-- ✅ Main Content Grid -->
        <Grid Margin="20" Background="Transparent">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>

            <!-- Center Content Area with Drop Support -->
            <Border Grid.Column="0" Background="#1B1E2B" CornerRadius="12" Margin="0,0,10,0">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="4" Opacity="0.25"/>
                </Border.Effect>
                <!-- Place the Grid directly as the Border's child (remove unnecessary comment) -->
                <Grid x:Name="DropTargetGrid"
                      AllowDrop="True"
                      Drop="DropTargetGrid_Drop"
                      DragOver="DropTargetGrid_DragOver"
                      Background="Transparent">
                    <ItemsControl x:Name="DroppedItemsControl"
                                  ItemsSource="{Binding DroppedItems}"
                                  Margin="20">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#2A2D3E" 
                                        CornerRadius="12" 
                                        Width="200" 
                                        Height="120" 
                                        Margin="10"
                                        Cursor="Hand"
                                        MouseLeftButtonDown="Card_Click"
                                        Tag="{Binding}">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" Opacity="0.2"/>
                                    </Border.Effect>
                                    <Grid Margin="15">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Icon and Close Button Row -->
                                        <Grid Grid.Row="0">
                                            <TextBlock Text="{Binding Icon}" 
                                                       FontSize="24" 
                                                       Foreground="{Binding IconColor}"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Center"/>
                                            <Button Content="✕" 
                                                    FontSize="12" 
                                                    Foreground="#B0BEC5"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Top"
                                                    Margin="0,-5,-5,-5"
                                                    Padding="5"
                                                    Click="RemoveCard_Click"
                                                    Tag="{Binding}"/>
                                        </Grid>
                                        
                                        <!-- Title -->
                                        <TextBlock Grid.Row="1" 
                                                   Text="{Binding Name}" 
                                                   Foreground="White" 
                                                   FontSize="14" 
                                                   FontWeight="Bold"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center"
                                                   TextWrapping="Wrap"
                                                   TextAlignment="Center"/>
                                        
                                        <!-- Description -->
                                        <TextBlock Grid.Row="2" 
                                                   Text="{Binding Description}" 
                                                   Foreground="#B0BEC5" 
                                                   FontSize="11"
                                                   VerticalAlignment="Bottom"
                                                   HorizontalAlignment="Center"
                                                   TextWrapping="Wrap"
                                                   TextAlignment="Center"
                                                   Margin="0,5,0,0"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>

            <!-- Right Panel - Enhanced Menu -->
            <Border Grid.Column="1" Background="#1B1E2B" CornerRadius="12">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="4" Opacity="0.25"/>
                </Border.Effect>
                <StackPanel Margin="0" Background="#1B1E2B">
                    
                    <!-- Panel Header -->
                    <Border Background="#2A2D3E" CornerRadius="12,12,0,0" Height="50">
                        <TextBlock Text="🚀 Quick Access Menu" 
                                   Foreground="#61A0FF" 
                                   FontSize="16" 
                                   FontWeight="Bold" 
                                   VerticalAlignment="Center" 
                                   HorizontalAlignment="Center"/>
                    </Border>
                    
                    <!-- Basic Section -->
                    <Expander Header="📋 Basic Functions" 
                              Foreground="#B0BEC5" 
                              FontWeight="SemiBold" 
                              Margin="15,10,15,5"
                              Background="Transparent" 
                              BorderThickness="0" 
                              IsExpanded="False">
                        <Expander.HeaderTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="📋" FontSize="14" Foreground="#4FC3F7" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Basic Functions" FontSize="12" Foreground="#B0BEC5" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                </StackPanel>
                            </DataTemplate>
                        </Expander.HeaderTemplate>
                        <ItemsControl ItemsSource="{Binding BasicMenuItems}" Margin="5,0">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Tag="{Binding}"
                                            PreviewMouseMove="MenuButton_PreviewMouseMove"
                                            Style="{StaticResource MenuButtonStyle}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Icon}" 
                                                       FontSize="16" 
                                                       Foreground="{Binding IconColor}"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"
                                                       TextOptions.TextFormattingMode="Display"/>
                                            <TextBlock Text="{Binding Name}" 
                                                       VerticalAlignment="Center"
                                                       Foreground="White"
                                                       FontSize="11"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Expander>
                    
                    <!-- Smart Section -->
                    <Expander Header="🧠 Smart Features" 
                              IsExpanded="True" 
                              Foreground="#61A0FF" 
                              FontWeight="Bold" 
                              Margin="15,5,15,15">
                        <Expander.HeaderTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="🧠" FontSize="14" Foreground="#FF6B9D" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Smart Features" FontSize="12" Foreground="#61A0FF" VerticalAlignment="Center" FontWeight="Bold"/>
                                </StackPanel>
                            </DataTemplate>
                        </Expander.HeaderTemplate>
                        <ItemsControl ItemsSource="{Binding SmartMenuItems}" Margin="5,0">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Tag="{Binding}"
                                            PreviewMouseMove="MenuButton_PreviewMouseMove"
                                            Style="{StaticResource MenuButtonStyle}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Icon}" 
                                                       FontSize="16" 
                                                       Foreground="{Binding IconColor}"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"
                                                       TextOptions.TextFormattingMode="Display"/>
                                            <TextBlock Text="{Binding Name}" 
                                                       VerticalAlignment="Center"
                                                       Foreground="White"
                                                       FontSize="11"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Expander>
                </StackPanel>
            </Border>
        </Grid>
    </DockPanel>
</Window>
